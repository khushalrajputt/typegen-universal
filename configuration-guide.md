# TypeGen Configuration Guide

## ?? New Features Added

### 1. **Navigation Property Filtering**
Automatically ignores Entity Framework navigation properties to keep TypeScript interfaces clean for frontend use.

### 2. **Nested Interface Generation**
Generates inline interfaces for complex types that don't have `[ExportToTs]` attribute.

## ?? Configuration Options

### Navigation Property Filtering

```json
{
  // Enable/disable automatic navigation property filtering
  "ignoreNavigationProperties": true,
  
  // Specific property names to ignore (case-insensitive)
  "propertiesToIgnore": [
    "CreatedByUser",
    "ModifiedByUser",
    "CustomNavigationProperty"
  ]
}
```

**What gets filtered out:**
- Virtual properties (EF navigation properties)
- Properties with `[ForeignKey]` attribute
- Properties with `[JsonIgnore]` attribute
- Properties in the `propertiesToIgnore` list
- Complex entity types that are likely navigation properties

### Nested Interface Generation

```json
{
  // Enable/disable inline interface generation for nested types
  "generateNestedInterfaces": true
}
```

## ?? Before and After Examples

### Example Entity

```csharp
[ExportToTs]
public class Document : Base
{
    public Guid DocumentGuid { get; set; }
    public Guid FileGuid { get; set; }
    public int EntityTypeId { get; set; }
    public Guid DocumentTypeGuid { get; set; }

    // Navigation properties (will be ignored)
    [ForeignKey(nameof(FileGuid))]
    public virtual UploadedFile UploadedFile { get; set; } = null!;
    
    [ForeignKey(nameof(EntityTypeId))]
    public virtual EntityType EntityType { get; set; } = null!;
    
    [ForeignKey(nameof(DocumentTypeGuid))]
    public virtual DocumentType DocumentType { get; set; } = null!;
}

// Base class with navigation properties
public class Base
{
    public bool IsActive { get; set; }
    public bool IsDeleted { get; set; }
    
    [JsonIgnore]
    public Guid? CreatedBy { get; set; }
    
    [JsonIgnore]
    public DateTime CreatedAt { get; set; }
    
    [JsonIgnore]
    public Guid? ModifiedBy { get; set; }
    
    [JsonIgnore]
    public DateTime? ModifiedAt { get; set; }

    // Navigation properties (will be ignored)
    [ForeignKey(nameof(CreatedBy))]
    [JsonIgnore]
    public virtual User CreatedByUser { get; set; } = null!;

    [ForeignKey(nameof(ModifiedBy))]
    [JsonIgnore]  
    public virtual User ModifiedByUser { get; set; } = null!;
}
```

### ? Before (Old Output)

```typescript
export interface DocumentType {
  documentTypeGuid: string;
  type?: string;
  isActive: boolean;
  isDeleted: boolean;
  createdBy?: string;
  createdAt: Date;
  modifiedBy?: string;
  modifiedAt?: Date;
  createdByUser?: User;      // ? Navigation property
  modifiedByUser?: User;     // ? Navigation property
}
```

### ? After (New Improved Output)

```typescript
// <auto-generated />
// Generated on 2024-01-15 10:30:00 UTC by TypeGen
// Changes to this file may be overwritten.

export interface DocumentType {
  documentTypeGuid?: string;
  type?: string;
  isActive?: boolean;
  isDeleted?: boolean;
  // Note: createdBy, createdAt, modifiedBy, modifiedAt are excluded due to [JsonIgnore]
  // Note: createdByUser, modifiedByUser are excluded as navigation properties
}
```

### Example with Nested Interface

If you have a type that references another complex type without `[ExportToTs]`:

```csharp
[ExportToTs]
public class OrderDto
{
    public Guid Id { get; set; }
    public string CustomerName { get; set; } = string.Empty;
    public AddressInfo ShippingAddress { get; set; } = null!; // No [ExportToTs]
}

// This class doesn't have [ExportToTs]
public class AddressInfo
{
    public string Street { get; set; } = string.Empty;
    public string City { get; set; } = string.Empty;
    public string ZipCode { get; set; } = string.Empty;
}
```

**Generated Output:**

```typescript
// <auto-generated />
// Generated on 2024-01-15 10:30:00 UTC by TypeGen
// Changes to this file may be overwritten.

interface IAddressInfo {
  street?: string;
  city?: string;
  zipCode?: string;
}

export interface OrderDto {
  id?: string;
  customerName?: string;
  shippingAddress?: IAddressInfo;
}
```

## ??? Advanced Configuration

### Full Configuration Example

```json
{
  // Database settings
  "connectionString": "Host=localhost;Database=SalesProDB;Username=salesProUser;Password=salesProUser;Port=5432",
  
  // Assembly scanning
  "assembliesToScan": [
    "../SalesPro.Service/bin/Debug/net8.0/SalesPro.Service.dll",
    "../SalesPro.Repository/bin/Debug/net8.0/SalesPro.Repository.dll"
  ],
  
  // Output paths
  "typeScriptInterfacesOutputPath": "./src/app/core/models/generated/",
  "typeScriptEnumsOutputPath": "./src/app/core/enums/generated/",
  "cSharpEnumsOutputPath": "../SalesPro.Service/Enums/Generated",
  
  // Database enum generation
  "databaseEnums": [
    {
      "tableName": "auth.roles",
      "keyColumn": "role_id",
      "valueColumn": "role",
      "enumName": "Roles",
      "namespace": "SalesPro.Service.Enums"
    },
    {
      "tableName": "ref.priority",
      "keyColumn": "priority_id",
      "valueColumn": "priority",
      "enumName": "Priority",
      "namespace": "SalesPro.Service.Enums"
    }
  ],
  
  // Generation behavior
  "generateIndexFiles": true,
  "useCamelCase": true,
  "addGeneratedHeaders": true,
  
  // ?? New filtering options
  "ignoreNavigationProperties": true,
  "generateNestedInterfaces": true,
  
  // ?? Properties to explicitly ignore
  "propertiesToIgnore": [
    "CreatedByUser",
    "ModifiedByUser",
    "SomeOtherNavigationProperty"
  ],
  
  // Type mappings
  "typeMappings": {
    "System.DateTime": "Date",
    "System.DateTimeOffset": "Date", 
    "System.Guid": "string",
    "System.TimeSpan": "string",
    "SalesPro.Repository.Entities.User": "UserReference"
  }
}
```

## ?? Property Filtering Logic

The TypeScript generator now uses this hierarchy to determine what to include:

1. **? Include** if property passes all filters
2. **? Skip** if property name is in `propertiesToIgnore` list
3. **? Skip** if `ignoreNavigationProperties` is true and property is:
   - Virtual property (EF navigation property pattern)
   - Has `[ForeignKey]` attribute
   - Complex entity type likely to be navigation property
4. **? Skip** if property has `[JsonIgnore]` attribute

## ?? Output Improvements Summary

### Clean Interfaces
- ? No navigation properties cluttering the interface
- ? Only frontend-relevant properties included  
- ? Respects JsonIgnore attributes

### Smart Nested Types
- ? Inline interfaces for complex types without ExportToTs
- ? Prevents circular references
- ? Maintains type safety

### Better Organization
- ? Clear separation of exported vs inline interfaces
- ? Logical property grouping
- ? Consistent naming conventions

This results in much cleaner, more maintainable TypeScript interfaces that are perfect for frontend development! ??